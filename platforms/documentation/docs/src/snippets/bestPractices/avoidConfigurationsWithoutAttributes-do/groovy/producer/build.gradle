import org.gradle.api.attributes.Usage

// tag::do-this[]
def CUSTOM_ATTRIBUTE = Attribute.of("custom", String) // <1>
dependencies.attributesSchema.attribute(CUSTOM_ATTRIBUTE)

configurations {
    consumable('customElements') {
        attributes { // <2>
            attribute(Category.CATEGORY_ATTRIBUTE, objects.named(Category, Category.LIBRARY))
            attribute(CUSTOM_ATTRIBUTE, "my-custom-value")
        }
    }
}

def generateFile = tasks.register('generateFile') {
    def outputFile = layout.buildDirectory.file('custom/output.txt')
    outputs.file(outputFile)
    doLast {
        outputFile.get().asFile.text = 'Custom output from producer'
    }
}

artifacts {
    customElements generateFile
}
// end::do-this[]
